<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Work with and manage your data efficiently in R with dplyr and tidyr</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>
<style type="text/css">
table {
    border-collapse: collapse;
}
thead {
    border-top: solid #DCDCDC;
    border-bottom: solid #DCDCDC;
}
tr.odd {
    background-color: #F8F8F8;
}
tr:last-child {
    border-bottom: solid #DCDCDC;
}
</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">AU Open Coders</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://au-oc.github.io">Main site</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Work with and manage your data efficiently in R with dplyr and tidyr</h1>

</div>


<div id="session-details" class="section level2">
<h2>Session details</h2>
<ul>
<li><strong>Date of session</strong>: 26 Oct, 2018</li>
<li><strong>Instructor</strong>: Elena Dudukina</li>
<li><strong>Session level</strong>: Beginner
<ul>
<li><strong>Part of the <a href="index.html">“Beginner Series”</a></strong></li>
</ul></li>
<li><p><strong>Required packages to install</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;tidyr&quot;</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># Or just use install tidyverse</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># install.packages(&quot;tidyverse&quot;)</span></a></code></pre></div></li>
</ul>
<div id="objectives" class="section level3">
<h3>Objectives</h3>
<ol style="list-style-type: decimal">
<li>To learn the difference between “messy” and “tidy” data and see the advantages of using data that are consistently structured.</li>
<li>To perform simple data transformations and create summaries.</li>
<li>To get to know the tools that help tidying up and reshaping the data.</li>
</ol>
<p><strong>At the end of this session you will be able:</strong></p>
<ol style="list-style-type: decimal">
<li>To write code using the <code>%&gt;%</code> operator.</li>
<li>To perform simple data transformations using dplyr function <code>mutate()</code>.</li>
<li>To select variables and observations to work with using dplyr functions <code>filter()</code>and <code>select()</code>.</li>
<li>To order data by variable using dplyr function <code>arrange()</code>.</li>
<li>To provide a simple data summary using dplyr functions <code>group_by()</code> and <code>summarise()</code>.</li>
<li>To change the structure of the data using tidyr functions <code>gather()</code> (and optionally <code>spread()</code>).</li>
</ol>
</div>
</div>
<div id="resources-for-learning-and-help" class="section level2">
<h2>Resources for learning and help</h2>
<p><strong>For learning</strong>:</p>
<ol style="list-style-type: decimal">
<li>“R for Data Science” book: <a href="http://r4ds.had.co.nz/tidy-data.html">Chapter on tidy data</a></li>
<li><a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidyr vignette</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">dplyr vignette</a></li>
<li>DataCamp course <a href="https://www.datacamp.com/courses/working-with-data-in-the-tidyverse">“Working with Data in the Tidyverse”</a>
<ul>
<li>Chapter 1 “Explore your data” is free (the following chapters are available after purchasing the DataCamp subscription)</li>
</ul></li>
</ol>
<p><strong>For help</strong>:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data wrangling cheatsheet</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/tidyr">StackOverflow for tidyr</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/dplyr">StackOverflow for dplyr</a></li>
<li>Quick package information using RStudio: <code>?tidyr</code>, <code>?dplyr</code></li>
</ol>
</div>
<div id="quickly-look-over-the-data-we-will-use" class="section level2">
<h2>Quickly look over the data we will use</h2>
<p>We’ll be using a very simple dataset that is built-in to the tidyr package. This dataset contains data on tuberculosis cases in Afghanistan, Brazil, and China from 1999 and 2000.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">names</span>(table1)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [1] &quot;country&quot;    &quot;year&quot;       &quot;cases&quot;      &quot;population&quot;</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">str</span>(table1)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    6 obs. of  4 variables:</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  $ country   : chr  &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Brazil&quot; &quot;Brazil&quot; ...</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  $ year      : int  1999 2000 1999 2000 1999 2000</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  $ cases     : int  745 2666 37737 80488 212258 213766</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  $ population: int  19987071 20595360 172006362 174504898 1272915272 1280428583</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="kw">summary</span>(table1)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;    country               year          cases          population       </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt;  Length:6           Min.   :1999   Min.   :   745   Min.   :1.999e+07  </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;  Class :character   1st Qu.:1999   1st Qu.: 11434   1st Qu.:5.845e+07  </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;  Mode  :character   Median :2000   Median : 59112   Median :1.733e+08  </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt;                     Mean   :2000   Mean   : 91277   Mean   :4.901e+08  </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;                     3rd Qu.:2000   3rd Qu.:179316   3rd Qu.:9.983e+08  </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;                     Max.   :2000   Max.   :213766   Max.   :1.280e+09</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co"># a tibble is a modified data.frame, making it slightly easier to use</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="kw">as_tibble</span>(table1)</a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a></code></pre></div>
</div>
<div id="exercise-choose-and-look-at-a-dataset" class="section level2">
<h2>Exercise: Choose and look at a dataset</h2>
<p>Create an <code>exercise.R</code> file (we will have done that in class) and put these code into the file. Then choose one of the below datasets that you will use for <strong>only the exercises</strong>:</p>
<ul>
<li><code>airquality</code> (<em>recommended for complete beginners</em>)</li>
<li><code>swiss</code> (<em>recommended for complete beginners</em>)</li>
<li><code>population</code></li>
<li><code>storms</code></li>
<li><code>starwars</code></li>
</ul>
<p>Copy the code below, replacing the <code>___</code> with the relevant dataset. This format is used throughout the session.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># load the packages</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># variables</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">names</span>(___)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># general contents</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw">str</span>(___)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co"># using the dplyr function</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="kw">glimpse</span>(___)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co"># quick summary</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw">summary</span>(___)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co"># compare a data.frame with a tibble</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="kw">as.data.frame</span>(___)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw">as_tibble</span>(___)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co"># convert your dataset into a tibble</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">___ &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(___)</a></code></pre></div>
</div>
<div id="messy-vs.-tidy-data" class="section level2">
<h2>“Messy” vs. “tidy” data</h2>
<p><strong>The dataset is tidy when:</strong></p>
<ul>
<li>Each variable has its own column.</li>
<li>Each observation has its own row</li>
<li>Each value has its own cell</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<p>Look at the structure of the toy tidyr datasets <code>table1</code>, <code>table3</code>, and <code>table4a</code>. Which is tidy?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">table1</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">table3</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;   country      year rate             </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 1 Afghanistan  1999 745/19987071     </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 2 Afghanistan  2000 2666/20595360    </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; 3 Brazil       1999 37737/172006362  </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 4 Brazil       2000 80488/174504898  </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 5 China        1999 212258/1272915272</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 6 China        2000 213766/1280428583</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21">table4a</a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;   country     `1999` `2000`</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; 1 Afghanistan    745   2666</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; 2 Brazil       37737  80488</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; 3 China       212258 213766</span></a></code></pre></div>
<p>More or less, <code>table1</code> is tidy while the others are not. That’s because in <code>table1</code>, each column has specific and unique information and each row represents a single observation from a single location at a single point in time.</p>
<p><strong>Benefits of tidy data and tidy code</strong>:</p>
<ol style="list-style-type: decimal">
<li>Time spent preparing your data at the beginning can save hours of frustration in the long run.</li>
<li>“Tidy data” provides a concept and the package tidyr provides the functions for this work.</li>
<li>Tibbles makes datasets efficient to work with.</li>
<li>dplyr provides fast and intuitive data processing functions.
<ul>
<li>For <em>very very large</em> datasets, the data.table package is very fast and powerful</li>
</ul></li>
<li>The <code>%&gt;%</code> pipe operator can help clarify complex data processing workflows.</li>
</ol>
</div>
<div id="pipe-operator" class="section level2">
<h2>Pipe operator: <code>%&gt;%</code></h2>
<ul>
<li>This operator allows you to pipe the output from one function to the input of another function.</li>
<li>Instead of nesting functions (reading from the inside to the outside), the idea of piping is to read the functions from left to right.</li>
<li>The <code>%&gt;%</code> pipe operator can help clarify complex data processing workflows.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># normal R way of nesting functions</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">glimpse</span>(table1))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Observations: 6</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Variables: 4</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; $ country    &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Brazil&quot;, &quot;Brazil&quot;, &quot;...</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; $ year       &lt;int&gt; 1999, 2000, 1999, 2000, 1999, 2000</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; $ cases      &lt;int&gt; 745, 2666, 37737, 80488, 212258, 213766</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; $ population &lt;int&gt; 19987071, 20595360, 172006362, 174504898, 127291527...</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co"># the pipe way of linking functions</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">table1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; Observations: 6</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; Variables: 4</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; $ country    &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Brazil&quot;, &quot;Brazil&quot;, &quot;...</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; $ year       &lt;int&gt; 1999, 2000, 1999, 2000, 1999, 2000</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; $ cases      &lt;int&gt; 745, 2666, 37737, 80488, 212258, 213766</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; $ population &lt;int&gt; 19987071, 20595360, 172006362, 174504898, 127291527...</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a></code></pre></div>
</div>
<div id="transforming-or-adding-variables-mutate" class="section level2">
<h2>Transforming or adding variables: <code>mutate()</code></h2>
<p>The <code>mutate()</code> function adds or replaces a variable/column in a dataset. To add</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Replace an existing variable</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">table1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">population =</span> population <span class="op">/</span><span class="st"> </span><span class="dv">1000000</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 1 Afghanistan  1999    745       20.0</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 2 Afghanistan  2000   2666       20.6</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 3 Brazil       1999  37737      172. </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 4 Brazil       2000  80488      175. </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 5 China        1999 212258     1273. </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; 6 China        2000 213766     1280.</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co"># Or create a new variable based on a condition</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">table1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">after_2000 =</span> <span class="kw">if_else</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt;   country      year  cases population after_2000</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071 no        </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 yes       </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 no        </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; 4 Brazil       2000  80488  174504898 yes       </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; 5 China        1999 212258 1272915272 no        </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; 6 China        2000 213766 1280428583 yes</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co"># Create or replace multiple variables by using the &quot;,&quot;</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28">table1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">new_column =</span> <span class="st">&quot;only one value&quot;</span>,</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">           <span class="dt">population =</span> population <span class="op">/</span><span class="st"> </span><span class="dv">1000000</span>)</a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;   country      year  cases population new_column    </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt; 1 Afghanistan  1999    745       20.0 only one value</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt; 2 Afghanistan  2000   2666       20.6 only one value</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt; 3 Brazil       1999  37737      172.  only one value</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt; 4 Brazil       2000  80488      175.  only one value</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt; 5 China        1999 212258     1273.  only one value</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; 6 China        2000 213766     1280.  only one value</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co"># Create a new variable using existing variables and save a new dataframe</span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42">table1_rate &lt;-<span class="st"> </span>table1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">rate =</span> (cases <span class="op">/</span><span class="st"> </span>population) <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb7-44" data-line-number="44">table1_rate</a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb7-49" data-line-number="49"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb7-50" data-line-number="50"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb7-51" data-line-number="51"><span class="co">#&gt; 4 Brazil       2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb7-52" data-line-number="52"><span class="co">#&gt; 5 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb7-53" data-line-number="53"><span class="co">#&gt; 6 China        2000 213766 1280428583 16.7</span></a></code></pre></div>
</div>
<div id="exercise-piping-transforming-and-adding" class="section level2">
<h2>Exercise: Piping, transforming, and adding</h2>
<p>Time: 10 min</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># explore the structure of the data</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">names</span>(___)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># pipe the data into mutate function and:</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">new_dataset &lt;-<span class="st"> </span>___ <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># dataset</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">        <span class="co"># 1. create a new variable</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">        <span class="dt">___ =</span> ___,</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">        <span class="co"># 2. transform/replace an existing variable</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">        <span class="dt">___ =</span> ___,</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">        <span class="co"># 3. create a new variable using a conditional</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12">        <span class="dt">___ =</span> <span class="kw">if_else</span>(___, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">    )</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">new_dataset</a></code></pre></div>
</div>
<div id="select-specific-data-by-the-variables-select" class="section level2">
<h2>Select specific data by the variables: <code>select()</code></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># select columns/variables by name, without quotes</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(country, year, rate)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;   country      year  rate</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; 1 Afghanistan  1999  3.73</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; 2 Afghanistan  2000 12.9 </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; 3 Brazil       1999 21.9 </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; 4 Brazil       2000 46.1 </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; 5 China        1999 16.7 </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; 6 China        2000 16.7</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co"># to *not* select a variable, us minus (-)</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>country)</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt;    year  cases population  rate</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt;   &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; 1  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; 2  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; 3  1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; 4  2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; 5  1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; 6  2000 213766 1280428583 16.7</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co"># when you have many variables with similar names, use &quot;matching&quot; functions</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;c&quot;</span>), <span class="kw">ends_with</span>(<span class="st">&quot;e&quot;</span>), <span class="kw">contains</span>(<span class="st">&quot;pop&quot;</span>))</a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt;   country      cases  rate population</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; 1 Afghanistan    745  3.73   19987071</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; 2 Afghanistan   2666 12.9    20595360</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; 3 Brazil       37737 21.9   172006362</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; 4 Brazil       80488 46.1   174504898</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt; 5 China       212258 16.7  1272915272</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; 6 China       213766 16.7  1280428583</span></a></code></pre></div>
</div>
<div id="filtersubset-the-data-by-row-based-on-values-and-conditions-filter" class="section level2">
<h2>Filter/subset the data by row based on values and conditions: <code>filter()</code></h2>
<p><strong>Warning</strong>: Filter using logic… and humans are very bad at logic… Make sure to be very certain that you think your logic is what the code reads as logic… Lots of mistakes can be made at this stage! Especially with complex logic situations.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># when country is equal to</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">    </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Brazil&quot;</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; # A tibble: 2 x 5</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;   country  year cases population  rate</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; 1 Brazil   1999 37737  172006362  21.9</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; 2 Brazil   2000 80488  174504898  46.1</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co"># when country is *not* equal to</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">    </span><span class="kw">filter</span>(country <span class="op">!=</span><span class="st"> &quot;Brazil&quot;</span>)</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; # A tibble: 4 x 5</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; 3 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; 4 China        2000 213766 1280428583 16.7</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co"># when year is equal to</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1999</span>)</a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; # A tibble: 3 x 5</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; 2 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; 3 China        1999 212258 1272915272 16.7</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co"># Or when year is equal to or more than</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1999</span>)</a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; 4 Brazil       2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; 5 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; 6 China        2000 213766 1280428583 16.7</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"></a>
<a class="sourceLine" id="cb10-44" data-line-number="44"><span class="co"># when year is 1999 *and* country is Brazil</span></a>
<a class="sourceLine" id="cb10-45" data-line-number="45">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1999</span> <span class="op">&amp;</span><span class="st"> </span>country <span class="op">==</span><span class="st"> &quot;Brazil&quot;</span>)</a>
<a class="sourceLine" id="cb10-47" data-line-number="47"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb10-48" data-line-number="48"><span class="co">#&gt;   country  year cases population  rate</span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49"><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-50" data-line-number="50"><span class="co">#&gt; 1 Brazil   1999 37737  172006362  21.9</span></a>
<a class="sourceLine" id="cb10-51" data-line-number="51"></a>
<a class="sourceLine" id="cb10-52" data-line-number="52"><span class="co"># when year is 1999 *or* country is Brazil</span></a>
<a class="sourceLine" id="cb10-53" data-line-number="53">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-54" data-line-number="54"><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1999</span> <span class="op">|</span><span class="st"> </span>country <span class="op">==</span><span class="st"> &quot;Brazil&quot;</span>)</a>
<a class="sourceLine" id="cb10-55" data-line-number="55"><span class="co">#&gt; # A tibble: 4 x 5</span></a>
<a class="sourceLine" id="cb10-56" data-line-number="56"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb10-57" data-line-number="57"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-58" data-line-number="58"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb10-59" data-line-number="59"><span class="co">#&gt; 2 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb10-60" data-line-number="60"><span class="co">#&gt; 3 Brazil       2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb10-61" data-line-number="61"><span class="co">#&gt; 4 China        1999 212258 1272915272 16.7</span></a></code></pre></div>
</div>
<div id="sortingrearranging-your-data-by-columnvariable-arrange" class="section level2">
<h2>Sorting/(re)arranging your data by column/variable: <code>arrange()</code></h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># ascending order by rate</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">    </span><span class="kw">arrange</span>(rate)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; 3 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; 4 China        2000 213766 1280428583 16.7 </span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; 5 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; 6 Brazil       2000  80488  174504898 46.1</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co"># descending order by rate</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(rate))</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; 1 Brazil       2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; 2 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; 3 China        2000 213766 1280428583 16.7 </span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt; 4 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt; 5 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt; 6 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co"># ascending order by year and rate</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="st">    </span><span class="kw">arrange</span>(year, rate)</a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#&gt; 2 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="co">#&gt; 4 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="co">#&gt; 5 China        2000 213766 1280428583 16.7 </span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="co">#&gt; 6 Brazil       2000  80488  174504898 46.1</span></a></code></pre></div>
</div>
<div id="exercise-filtering-and-logic-arranging-and-selecting" class="section level2">
<h2>Exercise: Filtering and logic, arranging, and selecting</h2>
<p>Time: 10 min</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># filter the rows by two variables</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># choose two numeric variables and two numbers</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">___ <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">    </span><span class="co"># format: variable &gt;= number</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">    </span><span class="co"># example: weight &gt;= 50</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">    </span><span class="kw">filter</span>(___ <span class="op">&gt;=</span><span class="st"> </span>___ <span class="op">&amp;</span><span class="st"> </span>___ <span class="op">&lt;=</span><span class="st"> </span>___)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co"># note the &quot;&amp;&quot; above, compare with &quot;|&quot; below</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co"># how do they differ?</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">___ <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">    </span><span class="kw">filter</span>(___ <span class="op">&gt;=</span><span class="st"> </span>___ <span class="op">|</span><span class="st"> </span>___ <span class="op">&lt;=</span><span class="st"> </span>___)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co"># pipe the data and continue piping</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">___ <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="st">    </span><span class="co"># filter a variable, preferably a character variable,</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">    </span><span class="kw">filter</span>(______  <span class="op">==</span><span class="st">  </span>______) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="st">    </span><span class="co"># sort by two variables</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="st">    </span><span class="kw">arrange</span>(___,   ___) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="st">    </span><span class="co"># now keep only three variables</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="st">    </span><span class="kw">select</span>(___,  ___,  ___) </a></code></pre></div>
<p>If you are familiar with ggplot2 from the ggplot2 session, then you can optional try to visualize the dataset.</p>
</div>
<div id="create-a-summary-of-the-data-alone-or-by-a-groups-group_by-summarise" class="section level2">
<h2>Create a summary of the data, alone or by a group(s): <code>group_by()</code>, <code>summarise()</code></h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># summarise on its own</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># summarise only can output one (1) value, eg. a max or an average</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cum_cases =</span> <span class="kw">sum</span>(cases),</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">              <span class="dt">max =</span> <span class="kw">max</span>(cases))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; # A tibble: 1 x 2</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt;   cum_cases    max</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;       &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; 1    547660 213766</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co"># grouping by country, on its own, does nothing</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">    </span><span class="kw">group_by</span>(country) </a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; # Groups:   country [3]</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071  3.73</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 12.9 </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 21.9 </span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; 4 Brazil       2000  80488  174504898 46.1 </span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#&gt; 5 China        1999 212258 1272915272 16.7 </span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#&gt; 6 China        2000 213766 1280428583 16.7</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co"># group_by combined with summarise is powerful</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="st">    </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cum_cases =</span> <span class="kw">sum</span>(cases),</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">              <span class="dt">max =</span> <span class="kw">max</span>(cases))</a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co">#&gt;   country     cum_cases    max</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="co">#&gt; 1 Afghanistan      3411   2666</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="co">#&gt; 2 Brazil         118225  80488</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="co">#&gt; 3 China          426024 213766</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="co"># grouping by year</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38">table1_rate <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cum_cases =</span> <span class="kw">sum</span>(cases),</a>
<a class="sourceLine" id="cb13-41" data-line-number="41">              <span class="dt">max =</span> <span class="kw">max</span>(cases))</a>
<a class="sourceLine" id="cb13-42" data-line-number="42"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43"><span class="co">#&gt;    year cum_cases    max</span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44"><span class="co">#&gt;   &lt;int&gt;     &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"><span class="co">#&gt; 1  1999    250740 212258</span></a>
<a class="sourceLine" id="cb13-46" data-line-number="46"><span class="co">#&gt; 2  2000    296920 213766</span></a></code></pre></div>
</div>
<div id="converting-to-long-form-gather" class="section level2">
<h2>Converting to long form: <code>gather()</code></h2>
<p>Compare how <code>table1</code> looks normally and after converting to the long form with <code>gather()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">table1</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co"># convert to long form by stacking all cases with all population</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">table1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="st">    </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>country, <span class="op">-</span>year)</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt;    country      year variable        value</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt;  1 Afghanistan  1999 cases             745</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt;  2 Afghanistan  2000 cases            2666</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt;  3 Brazil       1999 cases           37737</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt;  4 Brazil       2000 cases           80488</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt;  5 China        1999 cases          212258</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt;  6 China        2000 cases          213766</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt;  7 Afghanistan  1999 population   19987071</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt;  8 Afghanistan  2000 population   20595360</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt;  9 Brazil       1999 population  172006362</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt; 10 Brazil       2000 population  174504898</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt; 11 China        1999 population 1272915272</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt; 12 China        2000 population 1280428583</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co"># this does the same:</span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32">table1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="st">    </span><span class="kw">gather</span>(variable, value, cases, population)</a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#&gt;    country      year variable        value</span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="co">#&gt;  1 Afghanistan  1999 cases             745</span></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#&gt;  2 Afghanistan  2000 cases            2666</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#&gt;  3 Brazil       1999 cases           37737</span></a>
<a class="sourceLine" id="cb14-40" data-line-number="40"><span class="co">#&gt;  4 Brazil       2000 cases           80488</span></a>
<a class="sourceLine" id="cb14-41" data-line-number="41"><span class="co">#&gt;  5 China        1999 cases          212258</span></a>
<a class="sourceLine" id="cb14-42" data-line-number="42"><span class="co">#&gt;  6 China        2000 cases          213766</span></a>
<a class="sourceLine" id="cb14-43" data-line-number="43"><span class="co">#&gt;  7 Afghanistan  1999 population   19987071</span></a>
<a class="sourceLine" id="cb14-44" data-line-number="44"><span class="co">#&gt;  8 Afghanistan  2000 population   20595360</span></a>
<a class="sourceLine" id="cb14-45" data-line-number="45"><span class="co">#&gt;  9 Brazil       1999 population  172006362</span></a>
<a class="sourceLine" id="cb14-46" data-line-number="46"><span class="co">#&gt; 10 Brazil       2000 population  174504898</span></a>
<a class="sourceLine" id="cb14-47" data-line-number="47"><span class="co">#&gt; 11 China        1999 population 1272915272</span></a>
<a class="sourceLine" id="cb14-48" data-line-number="48"><span class="co">#&gt; 12 China        2000 population 1280428583</span></a></code></pre></div>
<p>Converting to long form makes other types of exploration much much easier. For instance, combined with <code>group_by()</code> and <code>summarise()</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">table1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">    </span><span class="kw">gather</span>(variables, values, cases, population) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">    </span><span class="kw">group_by</span>(year, variables) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cum_sum =</span> <span class="kw">sum</span>(values),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">              <span class="dt">max =</span> <span class="kw">sum</span>(values))</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; # A tibble: 4 x 4</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; # Groups:   year [?]</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt;    year variables     cum_sum        max</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;           &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; 1  1999 cases          250740     250740</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; 2  1999 population 1464908705 1464908705</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; 3  2000 cases          296920     296920</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; 4  2000 population 1475528841 1475528841</span></a></code></pre></div>
</div>
<div id="final-exercise-try-to-replicate-an-output." class="section level2">
<h2>Final exercise: Try to replicate an output.</h2>
<p>Time: Until end of the session.</p>
<p>Copy the code below and run it to get the dataset to use for this exercise. Using everything you learned in this session, try to recreate the table below from the dataset given.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">economics_data &lt;-<span class="st"> </span>economics <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">    </span><span class="co"># get the year information</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.numeric</span>(<span class="kw">substr</span>(date, <span class="dv">0</span>, <span class="dv">4</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">    </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">economics_data</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; # A tibble: 574 x 7</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt;    date         pce    pop psavert uempmed unemploy  year</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt;  1 1967-07-01  507. 198712    12.5     4.5     2944  1967</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt;  2 1967-08-01  510. 198911    12.5     4.7     2945  1967</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt;  3 1967-09-01  516. 199113    11.7     4.6     2958  1967</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt;  4 1967-10-01  513. 199311    12.5     4.9     3143  1967</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt;  5 1967-11-01  518. 199498    12.5     4.7     3066  1967</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt;  6 1967-12-01  526. 199657    12.1     4.8     3018  1967</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt;  7 1968-01-01  532. 199808    11.7     5.1     2878  1968</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#&gt;  8 1968-02-01  534. 199920    12.2     4.5     3001  1968</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt;  9 1968-03-01  545. 200056    11.6     4.1     2877  1968</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">#&gt; 10 1968-04-01  545. 200208    12.2     4.6     2709  1968</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">#&gt; # ... with 564 more rows</span></a></code></pre></div>
<table>
<caption>From the data above, try to recreate this data below in this table.</caption>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="left">variable</th>
<th align="right">Max</th>
<th align="right">Median</th>
<th align="right">Min</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2000</td>
<td align="left">uempmed</td>
<td align="right">6.3000000</td>
<td align="right">6.0000000</td>
<td align="right">5.2000000</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0208329</td>
<td align="right">0.0201725</td>
<td align="right">0.0194601</td>
</tr>
<tr class="odd">
<td align="right">1999</td>
<td align="left">uempmed</td>
<td align="right">6.9000000</td>
<td align="right">6.2500000</td>
<td align="right">5.8000000</td>
</tr>
<tr class="even">
<td align="right">1999</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0219826</td>
<td align="right">0.0210060</td>
<td align="right">0.0201378</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="left">uempmed</td>
<td align="right">7.4000000</td>
<td align="right">6.7500000</td>
<td align="right">5.8000000</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0233487</td>
<td align="right">0.0225944</td>
<td align="right">0.0215798</td>
</tr>
<tr class="odd">
<td align="right">1997</td>
<td align="left">uempmed</td>
<td align="right">8.3000000</td>
<td align="right">7.9500000</td>
<td align="right">7.5000000</td>
</tr>
<tr class="even">
<td align="right">1997</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0263782</td>
<td align="right">0.0244107</td>
<td align="right">0.0230113</td>
</tr>
<tr class="odd">
<td align="right">1996</td>
<td align="left">uempmed</td>
<td align="right">8.6000000</td>
<td align="right">8.3000000</td>
<td align="right">7.7000000</td>
</tr>
<tr class="even">
<td align="right">1996</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0279358</td>
<td align="right">0.0269796</td>
<td align="right">0.0254912</td>
</tr>
<tr class="odd">
<td align="right">1995</td>
<td align="left">uempmed</td>
<td align="right">9.1000000</td>
<td align="right">8.2500000</td>
<td align="right">7.9000000</td>
</tr>
<tr class="even">
<td align="right">1995</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0287671</td>
<td align="right">0.0278592</td>
<td align="right">0.0269421</td>
</tr>
<tr class="odd">
<td align="right">1994</td>
<td align="left">uempmed</td>
<td align="right">10.0000000</td>
<td align="right">9.1500000</td>
<td align="right">8.6000000</td>
</tr>
<tr class="even">
<td align="right">1994</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0329491</td>
<td align="right">0.0301162</td>
<td align="right">0.0273032</td>
</tr>
<tr class="odd">
<td align="right">1993</td>
<td align="left">uempmed</td>
<td align="right">8.6000000</td>
<td align="right">8.3000000</td>
<td align="right">8.0000000</td>
</tr>
<tr class="even">
<td align="right">1993</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0360485</td>
<td align="right">0.0346286</td>
<td align="right">0.0323953</td>
</tr>
<tr class="odd">
<td align="right">1992</td>
<td align="left">uempmed</td>
<td align="right">9.3000000</td>
<td align="right">8.6500000</td>
<td align="right">8.1000000</td>
</tr>
<tr class="even">
<td align="right">1992</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0391287</td>
<td align="right">0.0370310</td>
<td align="right">0.0363734</td>
</tr>
<tr class="odd">
<td align="right">1991</td>
<td align="left">uempmed</td>
<td align="right">7.8000000</td>
<td align="right">6.8500000</td>
<td align="right">6.0000000</td>
</tr>
<tr class="even">
<td align="right">1991</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0360757</td>
<td align="right">0.0342328</td>
<td align="right">0.0318196</td>
</tr>
<tr class="odd">
<td align="right">1990</td>
<td align="left">uempmed</td>
<td align="right">5.9000000</td>
<td align="right">5.3500000</td>
<td align="right">4.8000000</td>
</tr>
<tr class="even">
<td align="right">1990</td>
<td align="left">unemploy_rate</td>
<td align="right">0.0313998</td>
<td align="right">0.0274685</td>
<td align="right">0.0263759</td>
</tr>
</tbody>
</table>
</div>
<div id="if-time-converting-to-wide-form-with-spread" class="section level2">
<h2>(If time) Converting to wide form with <code>spread()</code></h2>
<p>To convert from long to wide, you use <code>spread()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># original</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">table2</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;    country      year type            count</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt;  1 Afghanistan  1999 cases             745</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt;  2 Afghanistan  1999 population   19987071</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt;  3 Afghanistan  2000 cases            2666</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt;  4 Afghanistan  2000 population   20595360</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt;  5 Brazil       1999 cases           37737</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt;  6 Brazil       1999 population  172006362</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt;  7 Brazil       2000 cases           80488</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#&gt;  8 Brazil       2000 population  174504898</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#&gt;  9 China        1999 cases          212258</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">#&gt; 10 China        1999 population 1272915272</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">#&gt; 11 China        2000 cases          213766</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">#&gt; 12 China        2000 population 1280428583</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co"># after spread</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">table2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="st">    </span><span class="kw">spread</span>(type, count)</a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a></code></pre></div>
</div>

<hr>

<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. See the <a href="LICENSE.html">licensing</a> page for more details about copyright information.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
