<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Create your own functions for package development in R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<style type="text/css">
table {
    border-collapse: collapse;
}
thead {
    border-top: solid #DCDCDC;
    border-bottom: solid #DCDCDC;
}
tr.odd {
    background-color: #F8F8F8;
}
tr:last-child {
    border-bottom: solid #DCDCDC;
}
</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */


</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">AU Open Coders</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://au-oc.github.io">Main site</a>
</li>
<li>
  <a href="https://github.com/au-oc/content">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Create your own functions for package development in R</h1>

</div>


<div id="session-details" class="section level2">
<h2>Session details</h2>
<ul>
<li><strong>Date of session:</strong> 23 Nov, 2018</li>
<li><strong>Instructor:</strong> Luke Johnston</li>
<li><strong>Session level:</strong> Intermediate
<ul>
<li><strong>Part of the <a href="index.html">‚ÄúPackage Development Series‚Äù</a></strong></li>
</ul></li>
<li><p><strong>Required packages to install</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;devtools&quot;</span>, <span class="st">&quot;usethis&quot;</span>, <span class="st">&quot;roxygen2&quot;</span>))</a></code></pre></div></li>
</ul>
<div id="objectives" class="section level3">
<h3>Objectives</h3>
<ol style="list-style-type: decimal">
<li>To learn how functions are structured and created.</li>
<li>To learn and apply the typical workflow for creating functions in packages (and in general).</li>
<li>To properly document and name functions so you don‚Äôt forget what they do! üòú</li>
</ol>
<p><strong>At the end of this session you will be able:</strong></p>
<ul>
<li>Create a function with several arguments.</li>
<li>Add and fill out roxygen documentation to the function.
<ul>
<li>Using the ‚ÄúCode‚Äù-&gt;‚ÄúInsert Roxygen Skeleton‚Äù (<code>Ctrl-Shift-Alt-R</code>)</li>
<li>Then creating the documentation using `devtools::</li>
</ul></li>
<li>Cycle between testing the function out in the <code>@example</code> section and developing the function.
<ul>
<li>Using <code>devtools::load_all()</code> (<code>Ctrl-Shift-L</code>).</li>
<li>Run the code in the <code>@example</code> by typing <code>Ctrl-Enter</code>.</li>
<li>Repeat until the function does what you want!</li>
</ul></li>
</ul>
<p><strong>Ultimately</strong>, I hope you will try to create a function from your own code by the end of this session!</p>
</div>
</div>
<div id="resources-for-learning-and-help" class="section level2">
<h2>Resources for learning and help</h2>
<ul>
<li>Generally, the <a href="http://r-pkgs.had.co.nz/">R Packages</a> book is great for anything related to making packages.</li>
<li><a href="http://r-pkgs.had.co.nz/r.html"><code>R/</code> chapter in R Packages</a> book (online and free).</li>
<li><a href="http://r-pkgs.had.co.nz/man.html">Documenting functions chapter</a> in R Packages book.</li>
<li><a href="https://r4ds.had.co.nz/functions.html">Functions chapter in R for Data Science</a> book, also online and free.</li>
<li><a href="https://swcarpentry.github.io/r-novice-inflammation/02-func-R/">Intro to functions</a> from <a href="https://software-carpentry.org/">Software Carpentry</a>.</li>
<li><a href="https://www.datacamp.com/courses/writing-functions-in-r">Functions in R</a> DataCamp course (need subscription).</li>
<li><a href="http://stat545.com/block011_write-your-own-function-01.html">STAT545</a> on writing functions from University of British Columbia, Canada.</li>
<li>Very advanced (for those interested) details about functions from <a href="http://adv-r.had.co.nz/Functions.html">Advanced R</a> book (again, online and free).</li>
</ul>
</div>
<div id="initial-setup" class="section level2">
<h2>Initial setup</h2>
<p>First we need to create a package layout and create an R script. See the <a href="pkg-creation.html">Package Creation</a> session for more details on this.</p>
<ol style="list-style-type: decimal">
<li>Create a package using <code>usethis::create_package(&quot;&lt;pkgname&gt;&quot;)</code></li>
<li>Add an R script using <code>usethis::use_r(&quot;&lt;scriptname&gt;.R&quot;)</code>.</li>
</ol>
</div>
<div id="all-actions-in-r-are-functions" class="section level2">
<h2>All actions in R are functions</h2>
<p>The <code>+</code> is a function, <code>mean()</code> is a function, <code>[]</code> is a function‚Ä¶ everything that does something is called a function in R. So to add 1 with 1:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>‚Ä¶ is a function that takes 1 and adds 1 to it. It is actually a short form for:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="st">`</span><span class="dt">+</span><span class="st">`</span>(<span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>When creating a function, there is always the basic structure of:</p>
<ol style="list-style-type: decimal">
<li>Name of the function (e.g. <code>mean</code>).</li>
<li>The function call using <code>function()</code> being assigned <code>&lt;-</code> to the name. This tells R that the name is a function object‚Ä¶ that it does some action.</li>
<li>The arguments within the function call, <code>function(arg1, arg2, arg3)</code>. These are the options given to the function (e.g. <code>sum(arg1, arg2)</code>).</li>
<li>The body of the function, that takes the arguments, if any, does some action, and finishes by outputting some result or object at the end (using <code>return()</code>).</li>
</ol>
<p>There is no minimum or maximum number of arguments you can provide for a function. E.g. you can have zero arguments or you can have 100s. To keep things sane, try to keep the number of arguments low, like not more than 4 or 5.</p>
<p>So, the structure is:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">name &lt;-<span class="st"> </span><span class="cf">function</span>(arg1, arg2) {</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="co"># body of function</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">}</a></code></pre></div>
<p>‚Ä¶ and an example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">add_nums &lt;-<span class="st"> </span><span class="cf">function</span>(num1, num2) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">    added &lt;-<span class="st"> </span>num1 <span class="op">+</span><span class="st"> </span>num2</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">    <span class="kw">return</span>(added)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">}</a></code></pre></div>
<p>You can use the new function by running the above code and writing out your new function, with arguments to give it.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">add_nums</span>(<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
<p>The function name is fairly good‚Ä¶ <code>add_nums</code> can be read as ‚Äúadd numbers‚Äù. But we need to also add some formal documentation to the function. Using the ‚ÄúInsert Roxygen Skeleton‚Äù in the ‚ÄúCode‚Äù menu list (or by typing <code>Ctrl-Shift-Alt-R</code>) you can add template documentation right above the function. It looks like:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#&#39; Title</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&#39; @param num1 </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&#39; @param num2 </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">add_nums &lt;-<span class="st"> </span><span class="cf">function</span>(num1, num2) {</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">    added &lt;-<span class="st"> </span>num1 <span class="op">+</span><span class="st"> </span>num2</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    <span class="kw">return</span>(added)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">}</a></code></pre></div>
<p>In the <code>Title</code> area, this is where you type out a brief sentence or several words that describe the function. Creating a new paragraph below this line allows you to add a more detailed description. The other items are:</p>
<ul>
<li><code>@param num</code> lines are to describe what each argument is for.</li>
<li><code>@return</code> describes what output the function provides. Is it a data.frame? A plot? What else does the output give?</li>
<li><code>@export</code> this is to tell R that this function should be accessible to the user of your package. Keep it in for now.</li>
<li><code>@examples</code> lines below this are used to show examples of how to use the function. This is also the area where you write and test that the function does what you want. You can run code here as if it was regular R code and not a commented out code by using <code>Ctrl-Enter</code>.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#&#39; Add two numbers together.</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&#39; This is just an example function to show how to create one.</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&#39; @param num1 A number here.</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&#39; @param num2 A number here.</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&#39; @return Returns the sum of the two numbers.</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&#39; add_nums(1, 1)</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14">add_nums &lt;-<span class="st"> </span><span class="cf">function</span>(num1, num2) {</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">    added &lt;-<span class="st"> </span>num1 <span class="op">+</span><span class="st"> </span>num2</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">    <span class="kw">return</span>(added)</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">}</a></code></pre></div>
<p>Now, when we run <code>devtools::document()</code> (or <code>Ctrl-Shift-D</code>), a file will be added to the <code>man/</code> folder. Now, when you type out <code>?add_nums</code> in the console, the help documentation will pop up on the ‚ÄúHelp‚Äù tab.</p>
<p>Ok, let‚Äôs get to something a bit more interesting. A common thing that people do (at least I do) is to create a similar plot on different variables and datasets. So this is a great example of using a function to simplify your code. We can also cover‚Ä¶ package/function dependencies! Since we will use ggplot2 to make the plot, we need some way to tell R that the functions come from ggplot2‚Ä¶ It‚Äôs <strong>very bad practice</strong> to use <code>library()</code> in your function and in your package. A function from usethis comes to the rescue! Use <code>usethis::use_package(&quot;ggplot2&quot;)</code> in the console. Some text will appear saying that ‚Äúggplot2 has been added to DESCRIPTION‚Äù and that ‚Äúplease refer to functions using ggplot2::fun‚Äù. So let‚Äôs do that!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">scatter_plot &lt;-<span class="st"> </span><span class="cf">function</span>(data, xvar, yvar) {</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">    graph &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> data, ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">x =</span> xvar, <span class="dt">y =</span> yvar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="kw">return</span>(graph)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">}</a></code></pre></div>
<p>Ok, we have the base for making a scatter plot. But! There are few things to talk about here first. First, ggplot2 will be confused by the <code>x = xvar</code> since it will think<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> you are asking for the <code>xvar</code> column in the dataset. So, we need to change <code>aes</code> to <code>aes_string</code> to force ggplot2 to read <code>xvar</code> as a character string that is the name of the column you want to plot. Next, it is useful in many cases to put a dot before your function arguments to differentiate your function arguments from other R objects. Let‚Äôs also add the Roxygen documentation. So:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#&#39; Create a scatter plot of two variables.</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&#39; @param .data The dataset.</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&#39; @param .xvar The x-axis variable.</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&#39; @param .yvar The y-axis variable.</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&#39; @return A scatter plot.</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&#39; scatter_plot(swiss, &quot;Education&quot;, &quot;Agriculture&quot;)</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13">scatter_plot &lt;-<span class="st"> </span><span class="cf">function</span>(.data, .xvar, .yvar) {</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">    graph &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> .data, ggplot2<span class="op">::</span><span class="kw">aes_string</span>(<span class="dt">x =</span> .xvar, <span class="dt">y =</span> .yvar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">    <span class="kw">return</span>(graph)</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">}</a></code></pre></div>
<p><img src="images/unnamed-chunk-11-1.png" width="360" /></p>
<p>Now we do <code>devtools::load_all()</code> (<code>Ctrl-Shift-L</code>) and run the code in the example (<code>Ctrl-Enter</code>). A quick note: Running code in the <code>@examples</code> section <em>only</em> works if you are in an R package project (the RStudio <code>.Rproj</code> file). If you are not in an R package, you can instead include the code to run the function below your new function, like so:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#&#39; Create a scatter plot of two variables.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&#39; @param .data The dataset.</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&#39; @param .xvar The x-axis variable.</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&#39; @param .yvar The y-axis variable.</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&#39; @return A scatter plot.</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">scatter_plot &lt;-<span class="st"> </span><span class="cf">function</span>(.data, .xvar, .yvar) {</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">    graph &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> .data, ggplot2<span class="op">::</span><span class="kw">aes_string</span>(<span class="dt">x =</span> .xvar, <span class="dt">y =</span> .yvar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">    <span class="kw">return</span>(graph)</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="kw">scatter_plot</span>(swiss, <span class="st">&quot;Education&quot;</span>, <span class="st">&quot;Agriculture&quot;</span>)</a></code></pre></div>
<p>Now, if we want to add some theme items, all graphs created from this function will get the new theme and appearance!</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#&#39; Create a scatter plot of two variables.</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&#39; @param .data The dataset.</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&#39; @param .xvar The x-axis variable.</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&#39; @param .yvar The y-axis variable.</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&#39; @return A scatter plot.</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&#39; scatter_plot(swiss, &quot;Education&quot;, &quot;Agriculture&quot;)</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">scatter_plot &lt;-<span class="st"> </span><span class="cf">function</span>(.data, .xvar, .yvar) {</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">    graph &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> .data, ggplot2<span class="op">::</span><span class="kw">aes_string</span>(<span class="dt">x =</span> .xvar, <span class="dt">y =</span> .yvar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">    <span class="kw">return</span>(graph)</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">}</a></code></pre></div>
<p><img src="images/unnamed-chunk-14-1.png" width="360" /></p>
<p>If you want to make sure that who ever uses your function will not use a wrong argument, you can use ‚Äúdefensive programming‚Äù via the <code>stopifnot()</code> function. This forces the code to only work if <code>xvar</code> and <code>yvar</code> are character (e.g. <code>&quot;this&quot;</code>) argument.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#&#39; Create a scatter plot of two variables.</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&#39; @param .data The dataset.</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&#39; @param .xvar The x-axis variable.</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&#39; @param .yvar The y-axis variable.</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&#39; @return A scatter plot.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&#39; scatter_plot(swiss, &quot;Education&quot;, &quot;Agriculture&quot;)</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">scatter_plot &lt;-<span class="st"> </span><span class="cf">function</span>(.data, .xvar, .yvar) {</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">    <span class="kw">stopifnot</span>(<span class="kw">is.character</span>(.xvar), <span class="kw">is.character</span>(.yvar))</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">    graph &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data =</span> .data, ggplot2<span class="op">::</span><span class="kw">aes_string</span>(<span class="dt">x =</span> .xvar, <span class="dt">y =</span> .yvar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">    <span class="kw">return</span>(graph)</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">}</a></code></pre></div>
</div>
<div id="exercise-make-your-own-function" class="section level2">
<h2>Exercise: Make your own function!</h2>
<p>Using this workflow, try to create, document, and test your own function! If you have some code that you already use repeatedly by copy and pasting, try to convert that code into a function. If you don‚Äôt have your own code, try converting these pieces of code into their own function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Code chunk 1:</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">one_species &lt;-<span class="st"> </span>iris[iris[<span class="st">&#39;Species&#39;</span>] <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>, ]</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">sepal_one_species &lt;-<span class="st"> </span>one_species[<span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>)]</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">means_sepal_one_species &lt;-<span class="st"> </span><span class="kw">sapply</span>(sepal_one_species, mean)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">means_sepal_one_species</a></code></pre></div>
</div>
<div id="other-notes" class="section level2">
<h2>Other notes</h2>
<p>There are a few other things to consider. In R there are different ‚Äúmethods‚Äù of functions. This is way above what is necessary for this session, but if you are curious <a href="http://adv-r.had.co.nz/S3.html">this website</a> has a great explanation of the different methods (e.g.¬†S3 methods). Be warned, the website is fairly advanced!</p>
<p>You can always look at the contents of all functions in R. So an example of an S3 function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Generic S3</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">print</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; function (x, ...) </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; UseMethod(&quot;print&quot;)</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; &lt;bytecode: 0x296d840&gt;</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; &lt;environment: namespace:base&gt;</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co"># Printing for data.frames</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">print.data.frame</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; function (x, ..., digits = NULL, quote = FALSE, right = TRUE, </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt;     row.names = TRUE) </span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt;     n &lt;- length(row.names(x))</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt;     if (length(x) == 0L) {</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt;         cat(sprintf(ngettext(n, &quot;data frame with 0 columns and %d row&quot;, </span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt;             &quot;data frame with 0 columns and %d rows&quot;), n), &quot;\n&quot;, </span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt;             sep = &quot;&quot;)</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt;     else if (n == 0L) {</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#&gt;         print.default(names(x), quote = FALSE)</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt;         cat(gettext(&quot;&lt;0 rows&gt; (or 0-length row.names)\n&quot;))</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#&gt;         m &lt;- as.matrix(format.data.frame(x, digits = digits, </span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#&gt;             na.encode = FALSE))</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">#&gt;         if (!isTRUE(row.names)) </span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">#&gt;             dimnames(m)[[1L]] &lt;- if (isFALSE(row.names)) </span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">#&gt;                 rep.int(&quot;&quot;, n)</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">#&gt;             else row.names</span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co">#&gt;         print(m, ..., quote = quote, right = right)</span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co">#&gt;     invisible(x)</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">#&gt; &lt;bytecode: 0xb5b288&gt;</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co">#&gt; &lt;environment: namespace:base&gt;</span></a></code></pre></div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The reason it won‚Äôt work is because ggplot2 is using what is called non-standard evaluation (NSE; check out <a href="https://cran.r-project.org/web/packages/lazyeval/vignettes/lazyeval.html">here</a> or <a href="https://dplyr.tidyverse.org/articles/programming.html">here</a> for more indepth look at what non-standard evaluation is). Because ggplot2 uses NSE, you will have to do things slightly differently, hence using <code>aes_string</code>.<a href="#fnref1" class="footnote-back">‚Ü©</a></p></li>
</ol>
</div>

<hr>

<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. See the <a href="LICENSE.html">licensing</a> page for more details about copyright information.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
